<div class="archive-search-section">
  <form [formGroup]="form">
    <div class="row">
      <h5>{{ 'ARCHIVE_SEARCH.TITLE_SEARCH' | translate }}</h5>
    </div>

    <div class="row justify-content-around">
      <div class="col-8 form-control">
        <vitamui-common-editable-input
          formControlName="archiveCriteria"
          [validator]="form?.get('archiveCriteria')?.validator"
          label="{{ 'ARCHIVE_SEARCH.TITLE_SEARCH_AREA' | translate }}"
        >
        </vitamui-common-editable-input>
      </div>
      <div class="col-1 form-control"></div>
      <div class="col-3 form-control text-right">
        <button type="button" class="btn primary" [disabled]="nbQueryCriteria === 0" (click)="submit()">
          {{ 'ARCHIVE_SEARCH.LAUNCH_SEARCH_ACTION' | translate }}
        </button>
      </div>
    </div>

    <div class="area-criteria">
      <ng-container *ngFor="let criteriaKey of searchCriteriaKeys">
        <ng-container *ngIf="searchCriterias.get(criteriaKey) as criteriaVal">
          <app-criteria-search
            [criteriaKey]="criteriaKey"
            [criteriaVal]="criteriaVal"
            (criteriaRemoveEvent)="removeCriteriaEvent($event)"
          ></app-criteria-search>
        </ng-container>
      </ng-container>
    </div>
    <div class="row area-criteria">
      <div class="d-flex justify-content-end button-space">
        <button [matMenuTriggerFor]="menu" class="mat-boutton">
          <button type="button" class="circle editable-field-cancel clickable">
            <i class="material-icons primary-save-icon">save</i>
          </button>
        </button>

        <mat-menu #menu="matMenu" class="my-menu">
          <button
            mat-menu-item
            [disabled]="!searchCriterias || searchCriterias.size <= 0"
            (click)="mapSearchCriteriaHistory()"
            class="btn-new-save"
          >
            <i class="material-icons btn-add">add</i>
            {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_SAVER.NEW_SAVE_MENU' | translate }}
          </button>
          <app-search-criteria-list (storedSearchCriteriaHistory)="showStoredSearchCriteria($event)"> </app-search-criteria-list>
        </mat-menu>
      </div>

      <div *ngIf="searchCriterias && searchCriterias.size > 0" class="d-flex justify-content-end div-btn-delete button-space">
        <button class="mat-boutton">
          <button type="button" class="circle editable-field-cancel clickable" (click)="clearCriterias()">
            <i class="material-icons primary-save-icon">delete</i>
          </button>
        </button>
      </div>

      <div class="row justify-content-around">
        <a class="hide-ink" *ngIf="!showCriteriaPanel" (click)="showHidePanel()">{{ 'ARCHIVE_SEARCH.SHOW_SEARCH_CRITERIA' | translate }}</a>
      </div>
    </div>

    <mat-tab-group [selectedIndex]="additionalSearchCriteriaCategoryIndex" (selectedIndexChange)="selectedCategoryChange($event)">
      <mat-tab label="{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.TITLE' | translate }}">
        <div class="card-criteria" *ngIf="showCriteriaPanel">
          <div class="row">
            <div class="col-11">
              <div class="row justify-content-around">
                <div class="col-11 form-control">
                  <h5>{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.TITLE' | translate }}</h5>
                </div>
              </div>
              <div class="row justify-content-around">
                <div class="col-6 form-control">
                  <vitamui-common-editable-input
                    formControlName="title"
                    [validator]="form?.get('title')?.validator"
                    label="{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.TITLE' | translate }}"
                  >
                  </vitamui-common-editable-input>
                </div>
                <div class="col-4 form-control">
                  <div class="vitamui-input" (click)="pickerBegin.open()">
                    <span *ngIf="!form.get('beginDt').value; else showBeginDt" (click)="pickerBegin.open()" class="search-date-label">{{
                      'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.START_DATE' | translate
                    }}</span>
                    <ng-template #showBeginDt
                      ><span (click)="pickerBegin.open()">{{ form.get('beginDt').value | date: 'dd/MM/yyyy' }} </span>
                    </ng-template>
                    <input
                      class="hidden"
                      size="0"
                      [matDatepicker]="pickerBegin"
                      formControlName="beginDt"
                      [min]="form.get('beginDt').value"
                    />
                    <mat-datepicker #pickerBegin></mat-datepicker>
                  </div>
                </div>
              </div>

              <div class="row justify-content-around">
                <div class="col-6 form-control">
                  <vitamui-common-editable-input
                    formControlName="description"
                    [validator]="form?.get('description')?.validator"
                    label="{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.DESCRIPTION' | translate }}"
                  >
                  </vitamui-common-editable-input>
                </div>
                <div class="col-4 form-control">
                  <div class="vitamui-input" (click)="pickerEnd.open()">
                    <span *ngIf="!form.get('endDt').value; else showEndDt" (click)="pickerEnd.open()" class="search-date-label">{{
                      'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE' | translate
                    }}</span>
                    <ng-template #showEndDt
                      ><span (click)="pickerEnd.open()">{{ form.get('endDt').value | date: 'dd/MM/yyyy' }} </span>
                    </ng-template>
                    <input class="hidden" size="0" [matDatepicker]="pickerEnd" formControlName="endDt" [min]="form.get('endDt').value" />
                    <mat-datepicker #pickerEnd></mat-datepicker>
                  </div>
                </div>
              </div>
              <div class="row justify-content-around">
                <div class="col-6 form-control">
                  <vitamui-common-editable-input
                    formControlName="guid"
                    [validator]="form?.get('guid')?.validator"
                    label="{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.GUID' | translate }}"
                  >
                  </vitamui-common-editable-input>
                </div>
                <div class="col-4 form-control"></div>
              </div>
              <div class="row justify-content-around">
                <div class="col-6 form-control">
                  <vitamui-common-editable-input
                    formControlName="uaid"
                    [validator]="form?.get('uaid')?.validator"
                    label="{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.UAID' | translate }}"
                  >
                  </vitamui-common-editable-input>
                </div>
                <div class="col-4 form-control"></div>
              </div>

              <div class="row justify-content-around">
                <div class="col-6 form-control">
                  <h5>{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.SP' | translate }}</h5>
                </div>
                <div class="col-4 form-control">
                  <h5>{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.OTHER_FIELD' | translate }}</h5>
                </div>
              </div>

              <div class="row justify-content-around">
                <div class="col-3 form-control">
                  <vitamui-common-editable-input
                    formControlName="serviceProdCode"
                    [validator]="form?.get('serviceProdCode')?.validator"
                    label="{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.SP_CODE' | translate }}"
                  >
                  </vitamui-common-editable-input>
                </div>
                <div class="col-2 form-control"></div>
                <div class="col-4 form-control">
                  <mat-form-field class="vitamui-mat-select search-input-criteria">
                    <mat-select
                      formControlName="otherCriteria"
                      style="font-size: 14px; font-weight: 700; color: var(--vitamui-primary)"
                      placeholder="{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.OTHER_FIELD' | translate }}"
                      (valueChange)="onSelectOtherCriteria()"
                    >
                      <mat-option value="" style="font-size: 14px; font-weight: 700; color: var(--vitamui-primary)">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.SELECT_OTHER_FIELD' | translate }}
                      </mat-option>
                      <ng-container *ngFor="let ontology of this.ontologies">
                        <mat-option
                          style="font-size: 14px; font-weight: 700; color: var(--vitamui-primary)"
                          value="{{ ontology.Value }}"
                          matTooltip="{{ ontology?.Value }}"
                          matTooltipClass="vitamui-tooltip"
                          [matTooltipShowDelay]="300"
                          >{{ ontology.Label }}
                        </mat-option>
                      </ng-container>
                    </mat-select>
                    <div class="select-arrow">
                      <i class="vitamui-icon vitamui-icon-search vitamui-row-icon"></i>
                    </div>
                    <div class="select-arrow">
                      <i class="material-icons">keyboard_arrow_up</i>
                      <i class="material-icons">keyboard_arrow_down</i>
                    </div>
                  </mat-form-field>
                </div>
              </div>
              <div class="row justify-content-around">
                <div class="col-6 form-control">
                  <vitamui-common-editable-input
                    formControlName="serviceProdLabel"
                    [validator]="form?.get('serviceProdLabel')?.validator"
                    label="{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.SP_LABEL' | translate }}"
                  >
                  </vitamui-common-editable-input>
                </div>
                <div class="col-4 form-control">
                  <vitamui-common-editable-input
                    formControlName="otherCriteriaValue"
                    *ngIf="
                      otherCriteriaValueEnabled &&
                      (otherCriteriaValueType === 'KEYWORD' ||
                        otherCriteriaValueType === 'TEXT' ||
                        otherCriteriaValueType === 'LONG' ||
                        otherCriteriaValueType === 'DOUBLE' ||
                        otherCriteriaValueType === 'BOOLEAN')
                    "
                    [validator]="form?.get('otherCriteriaValue')?.validator"
                    label="{{ selectedValueOntolonogy }}"
                  >
                  </vitamui-common-editable-input>

                  <div
                    class="vitamui-input"
                    (click)="pickerOtherCriteria.open()"
                    *ngIf="otherCriteriaValueEnabled && otherCriteriaValueType === 'DATE'"
                  >
                    <span
                      *ngIf="!form.get('otherCriteriaValue').value; else showOtherCriteria"
                      (click)="pickerOtherCriteria.open()"
                      class="search-date-label"
                      >{{ selectedValueOntolonogy }}</span
                    >
                    <ng-template #showOtherCriteria
                      ><span (click)="pickerOtherCriteria.open()">{{ form.get('otherCriteriaValue').value | date: 'dd/MM/yyyy' }} </span>
                    </ng-template>
                    <input
                      class="hidden"
                      size="0"
                      [matDatepicker]="pickerOtherCriteria"
                      formControlName="otherCriteriaValue"
                      [min]="form.get('otherCriteriaValue').value"
                    />
                    <mat-datepicker #pickerOtherCriteria></mat-datepicker>
                  </div>
                </div>
              </div>

              <div class="row justify-content-center hide-area-search">
                <div class="col-7 form-control"></div>
                <div class="col-4 form-control">
                  <a class="hide-ink" (click)="showHidePanel()">{{ 'ARCHIVE_SEARCH.HIDE_SEARCH_CRITERIA' | translate }}</a>
                </div>
              </div>
              <div class="row justify-content-center"></div>
            </div>
          </div>
        </div>
      </mat-tab>
      <mat-tab *ngFor="let category of additionalSearchCriteriaCategories; let index = index">
        <ng-template mat-tab-label>
          <span> {{ 'ARCHIVE_SEARCH.CRITERIA_CATEGORY.' + category.name | translate }} </span>
          <button class="mat-boutton clickable" (click)="removeCriteriaCategory(category.name)">
            <i class="vitamui-icon vitamui-icon-cross vitamui-row-icon"></i>
          </button>
        </ng-template>
        <ng-container *ngIf="category.name === 'DUA'">
          <div class="card-criteria" *ngIf="showCriteriaPanel">
            <div class="row">
              <div class="col-11">
                <div class="row justify-content-around">
                  <div class="col-11 form-control">
                    <h5>{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.DUA_TITLE' | translate }}</h5>
                  </div>
                </div>

                <div class="row justify-content-around">
                  <div class="col-5 form-control">
                    <vitamui-common-editable-input
                      formControlName="appraisalRuleIdentifier"
                      [validator]="form?.get('appraisalRuleIdentifier')?.validator"
                      label="{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.ID_DUA' | translate }}"
                    >
                    </vitamui-common-editable-input>
                  </div>
                  <div class="col-1 form-control"></div>
                  <div class="col-4 form-control">
                    <vitamui-common-editable-input
                      formControlName="appraisalRuleTitle"
                      [validator]="form?.get('appraisalRuleTitle')?.validator"
                      label="{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.TITLE_DUA' | translate }}"
                    >
                    </vitamui-common-editable-input>
                  </div>
                  <div class="col-1 form-control"></div>
                </div>

                <div class="row justify-content-around">
                  <div class="col-5 form-control">
                    <div class="vitamui-input" (click)="pickerBeginDua.open()">
                      <span
                        *ngIf="!form.get('appraisalRuleStartDate').value; else showBeginDtDua"
                        (click)="pickerBeginDua.open()"
                        class="search-date-label"
                        >{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.START_DATE_DUA' | translate }}</span
                      >
                      <ng-template #showBeginDtDua
                        ><span (click)="pickerBeginDua.open()">{{ form.get('appraisalRuleStartDate').value | date: 'dd/MM/yyyy' }} </span>
                      </ng-template>
                      <input
                        class="hidden"
                        size="0"
                        [matDatepicker]="pickerBeginDua"
                        formControlName="appraisalRuleStartDate"
                        [min]="form.get('appraisalRuleStartDate').value"
                      />
                      <mat-datepicker #pickerBeginDua></mat-datepicker>
                    </div>
                  </div>
                  <div class="col-1 form-control"></div>
                  <div class="col-4 form-control">
                    <p
                      *ngIf="!showDuaEndDate"
                      class="text medium text-primary bold text-clicable-uppercase"
                      (click)="showHideDuaEndDate(true)"
                    >
                      {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.DUA.CREATE_INTERVAL' | translate }}
                    </p>

                    <div class="vitamui-input" (click)="pickerEndDua.open()" *ngIf="showDuaEndDate">
                      <span
                        *ngIf="!form.get('appraisalRuleEndDate').value; else showEndDtDua"
                        (click)="pickerEndDua.open()"
                        class="search-date-label"
                        >{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.END_DATE_DUA' | translate }}</span
                      >
                      <ng-template #showEndDtDua
                        ><span (click)="pickerEndDua.open()">{{ form.get('appraisalRuleEndDate').value | date: 'dd/MM/yyyy' }} </span>
                      </ng-template>
                      <input
                        class="hidden"
                        size="0"
                        [matDatepicker]="pickerEndDua"
                        formControlName="appraisalRuleEndDate"
                        [min]="form.get('appraisalRuleEndDate').value"
                      />
                      <mat-datepicker #pickerEndDua></mat-datepicker>
                    </div>
                  </div>
                  <div class="col-1 form-control">
                    <p
                      *ngIf="showDuaEndDate"
                      class="text medium text-primary bold text-clicable-uppercase"
                      (click)="showHideDuaEndDate(false)"
                    >
                      {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.DUA.DELETE_INTERVAL' | translate }}
                    </p>
                  </div>
                </div>

                <div class="row justify-content-around padding-bottom-medium">
                  <div class="col-3 form-control" formGroupName="appraisalRuleOrigin">
                    <div class="row criteria-choice">
                      <p class="text medium text-primary bold">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.TITLE' | translate }}
                      </p>
                    </div>

                    <div class="row criteria-choice">
                      <input
                        class="criteria-choice-input"
                        type="checkbox"
                        id="HAS_AT_LEAST_ONE_APPRAISAL_RULE_ORIGIN"
                        formControlName="hasAtLeastOne"
                      />

                      <label for="HAS_AT_LEAST_ONE_APPRAISAL_RULE_ORIGIN" class="form-check-label">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_AT_LEAST_ONE_APPRAISAL_RULE' | translate }}</label
                      >
                    </div>
                    <div class="row criteria-choice">
                      <input
                        class="criteria-choice-input"
                        type="checkbox"
                        id="INHERITE_AT_LEAST_ONE_APPRAISAL_RULE_ORIGIN"
                        formControlName="inheriteAtLeastOne"
                      />

                      <label for="INHERITE_AT_LEAST_ONE_APPRAISAL_RULE_ORIGIN" class="form-check-label">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.INHERITE_AT_LEAST_ONE_APPRAISAL_RULE' | translate }}</label
                      >
                    </div>

                    <div class="row criteria-choice">
                      <input class="criteria-choice-input" id="HAS_NO_APPRAISAL_RULE_ORIGIN" type="checkbox" formControlName="hasNoOne" />

                      <label for="HAS_NO_APPRAISAL_RULE_ORIGIN" class="form-check-label">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.HAS_NO_APPRAISAL_RULE' | translate }}</label
                      >
                    </div>
                    <div class="row criteria-choice">
                      <input
                        class="criteria-choice-input"
                        id="WAITING_TO_RE_CALCULATE_APPRAISAL_RULE_ORIGIN"
                        type="checkbox"
                        formControlName="waitingRecalculate"
                      />
                      <label for="WAITING_TO_RE_CALCULATE_APPRAISAL_RULE_ORIGIN" class="form-check-label">
                        {{
                          'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.ORIGIN.WAITING_TO_RE_CALCULATE_APPRAISAL_RULE' | translate
                        }}</label
                      >
                    </div>
                  </div>
                  <div class="col-3 form-control" formGroupName="appraisalRuleFinalAction">
                    <div class="row criteria-choice">
                      <p class="text medium text-primary bold">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION_TYPE.TITLE' | translate }}
                      </p>
                    </div>
                    <div class="row criteria-choice">
                      <input
                        class="criteria-choice-input"
                        id="SELECT_ALL_APPRAISAL_RULE_FINAL_ACTION_TYPE"
                        type="checkbox"
                        formControlName="anyFinalAction"
                      />
                      <label for="SELECT_ALL_APPRAISAL_RULE_FINAL_ACTION_TYPE" class="form-check-label">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION_TYPE.SELECT_ALL_APPRAISAL_RULE' | translate }}</label
                      >
                    </div>
                    <div class="row criteria-choice sub-choice">
                      <input
                        class="criteria-choice-input"
                        id="HAS_APPRAISAL_RULE_FINAL_ACTION_TYPE"
                        type="checkbox"
                        formControlName="hasFinalAction"
                      />

                      <label for="HAS_APPRAISAL_RULE_FINAL_ACTION_TYPE" class="form-check-label">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION_TYPE.HAS_APPRAISAL_RULE' | translate }}</label
                      >
                    </div>
                    <div class="row criteria-choice sub-choice">
                      <input
                        class="criteria-choice-input"
                        type="checkbox"
                        id="INHERITE_APPRAISAL_RULE_FINAL_ACTION_TYPE"
                        formControlName="inheriteFinalAction"
                      />

                      <label for="INHERITE_APPRAISAL_RULE_FINAL_ACTION_TYPE" class="form-check-label">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION_TYPE.INHERITE_APPRAISAL_RULE' | translate }}</label
                      >
                    </div>
                  </div>
                  <div class="col-2 form-control" formGroupName="appraisalRuleFinalActionType">
                    <div class="row criteria-choice">
                      <p class="text medium text-primary bold">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.TITLE' | translate }}
                      </p>
                    </div>
                    <div class="row criteria-choice">
                      <input
                        class="criteria-choice-input"
                        id="SELECT_ALL_APPRAISAL_RULE_FINAL_ACTION"
                        type="checkbox"
                        formControlName="anyFinalActionType"
                      />
                      <label for="SELECT_ALL_APPRAISAL_RULE_FINAL_ACTION" class="form-check-label">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.SELECT_ALL_APPRAISAL_RULE' | translate }}</label
                      >
                    </div>
                    <div class="row criteria-choice sub-choice">
                      <input
                        class="criteria-choice-input"
                        type="checkbox"
                        id="ELIMINATION_APPRAISAL_RULE_FINAL_ACTION"
                        formControlName="eliminationFinalActionType"
                        value="appraisalRuleFinalActionType.eliminationFinalActionType"
                      />

                      <label for="ELIMINATION_APPRAISAL_RULE_FINAL_ACTION" class="form-check-label">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.ELIMINATION_APPRAISAL_RULE' | translate }}</label
                      >
                    </div>
                    <div class="row criteria-choice sub-choice">
                      <input
                        class="criteria-choice-input"
                        id="CONSERVATION_APPRAISAL_RULE_FINAL_ACTION"
                        type="checkbox"
                        formControlName="conservationFinalActionType"
                      />

                      <label for="CONSERVATION_APPRAISAL_RULE_FINAL_ACTION" class="form-check-label">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.CONSERVATION_APPRAISAL_RULE' | translate }}</label
                      >
                    </div>
                    <div class="row criteria-choice sub-choice">
                      <input
                        class="criteria-choice-input"
                        id="NC_APPRAISAL_RULE_FINAL_ACTION"
                        type="checkbox"
                        formControlName="notSpecifiedFinalActionType"
                        value="notSpecifiedFinalActionType"
                      />

                      <label for="NC_APPRAISAL_RULE_FINAL_ACTION" class="form-check-label">
                        {{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.FINAL_ACTION.NC_APPRAISAL_RULE' | translate }}</label
                      >
                    </div>
                  </div>

                  <div class="col-2 form-control"></div>
                </div>

                <div class="row justify-content-around">
                  <div class="col-5 form-control">
                    <vitamui-common-editable-input
                      formControlName="appraisalRuleEliminationIdentifier"
                      [validator]="form?.get('appraisalRuleEliminationIdentifier')?.validator"
                      label="{{ 'ARCHIVE_SEARCH.SEARCH_CRITERIA_FILTER.FIELDS.ELIMINATION_TECHNICAL_ID' | translate }}"
                    >
                    </vitamui-common-editable-input>
                  </div>
                  <div class="col-6 form-control"></div>
                </div>
              </div>
            </div>
          </div>
        </ng-container>
      </mat-tab>

      <mat-tab disabled>
        <ng-template mat-tab-label>
          <button [matMenuTriggerFor]="menuTabs" class="mat-boutton clickable">
            {{ 'ARCHIVE_SEARCH.CRITERIA_CATEGORY.ADD' | translate }}
            <i class="vitamui-icon vitamui-icon-plus vitamui-row-icon"></i>
          </button>
        </ng-template>
      </mat-tab>

      <mat-menu #menuTabs="matMenu" class="my-menu">
        <button mat-menu-item class="btn-new-save" (click)="addCriteriaCategory('DUA')" [disabled]="isCategoryAdded('DUA')">
          {{ 'ARCHIVE_SEARCH.CRITERIA_CATEGORY.DUA' | translate }}
        </button>
        <button mat-menu-item class="btn-new-save" (click)="addCriteriaCategory('DUC')" [disabled]="isCategoryAdded('DUC')">
          {{ 'ARCHIVE_SEARCH.CRITERIA_CATEGORY.DUC' | translate }}
        </button>
        <button
          mat-menu-item
          class="btn-new-save"
          (click)="addCriteriaCategory('COMMUNICABILITY')"
          [disabled]="isCategoryAdded('COMMUNICABILITY')"
        >
          {{ 'ARCHIVE_SEARCH.CRITERIA_CATEGORY.COMMUNICABILITY' | translate }}
        </button>
        <button mat-menu-item class="btn-new-save" (click)="addCriteriaCategory('REUSING')" [disabled]="isCategoryAdded('REUSING')">
          {{ 'ARCHIVE_SEARCH.CRITERIA_CATEGORY.REUSING' | translate }}
        </button>
        <button mat-menu-item class="btn-new-save" (click)="addCriteriaCategory('DIFFUSION')" [disabled]="isCategoryAdded('DIFFUSION')">
          {{ 'ARCHIVE_SEARCH.CRITERIA_CATEGORY.DIFFUSION' | translate }}
        </button>
        <button
          mat-menu-item
          class="btn-new-save"
          (click)="addCriteriaCategory('CLASSIFICATION')"
          [disabled]="isCategoryAdded('CLASSIFICATION')"
        >
          {{ 'ARCHIVE_SEARCH.CRITERIA_CATEGORY.CLASSIFICATION' | translate }}
        </button>
        <button mat-menu-item class="btn-new-save" (click)="addCriteriaCategory('GEL')" [disabled]="isCategoryAdded('GEL')">
          {{ 'ARCHIVE_SEARCH.CRITERIA_CATEGORY.GEL' | translate }}
        </button>
      </mat-menu>
    </mat-tab-group>
  </form>
</div>

<div vitamuiCommonInfiniteScroll (vitamuiScroll)="loadMore()" *ngIf="submited">
  <div class="vitamui-table">
    <div class="vitamui-table-head">
      <div class="col-8" *ngIf="totalResults > 1 || totalResults === 0">{{ totalResults }} {{ 'ARCHIVE_SEARCH.RESULTS' | translate }}</div>
      <div class="col-8" *ngIf="totalResults === 1">{{ totalResults }} {{ 'ARCHIVE_SEARCH.RESULT' | translate }}</div>
      <div class="col-4 area-download">
        <a class="hide-ink" (click)="exportArchiveUnitsToCsvFile()" *ngIf="totalResults > 0"
          >{{ 'ARCHIVE_SEARCH.EXPORT_CSV.EXPORT_SEARCHS' | translate }}
          <i class="vitamui-icon vitamui-icon-download-basic vitamui-row-icon icon-download"></i>
        </a>
      </div>
    </div>

    <div class="vitamui-table-head">
      <div class="col-1 d-flex align-items-center">
        <button
          class="vitamui-filter-button"
          [vitamuiCommonTableFilter]="typeFilterTemplate"
          [class.active]="filterMapType['Type'] && filterMapType['Type'].length > 0"
        >
          <i class="material-icons vitamui-row-icon">filter_list</i>
        </button>

        <ng-template #typeFilterTemplate>
          <vitamui-common-table-filter [(filter)]="filterMapType['Type']" (filterChange)="onFilterChange('Type', $event)">
            <vitamui-common-table-filter-option value="Folder">
              <div class="table-filter-icon">
                <i class="vitamui-icon vitamui-icon-folder vitamui-row-icon status-badge"></i> {{ 'ARCHIVE_SEARCH.FOLDER' | translate }}
              </div>
            </vitamui-common-table-filter-option>
            <vitamui-common-table-filter-option value="Document">
              <div class="table-filter-icon">
                <i class="vitamui-icon vitamui-icon-file vitamui-row-icon status-badge"></i>
                {{ 'ARCHIVE_SEARCH.DOCUMENT' | translate }}
              </div>
            </vitamui-common-table-filter-option>
          </vitamui-common-table-filter>
        </ng-template>

        <vitamui-common-order-by-button
          orderByKey="DescriptionLevel"
          [(orderBy)]="orderBy"
          [(direction)]="direction"
          (orderChange)="emitOrderChange()"
        ></vitamui-common-order-by-button>
      </div>

      <div class="col-5 d-flex align-items-center">
        <span
          >{{ 'ARCHIVE_SEARCH.ARCHIVE_UNIT.FIELDS.NAME' | translate }} <br />{{
            'ARCHIVE_SEARCH.ARCHIVE_UNIT.FIELDS.DESCRIPTION' | translate
          }}</span
        >

        <vitamui-common-order-by-button
          orderByKey="Title"
          [(orderBy)]="orderBy"
          [(direction)]="direction"
          (orderChange)="emitOrderChange()"
        ></vitamui-common-order-by-button>
      </div>

      <div class="col-2 d-flex align-items-center">
        <span>{{ 'ARCHIVE_SEARCH.ARCHIVE_UNIT.FIELDS.START_DATE' | translate }} </span>
        <vitamui-common-order-by-button
          orderByKey="StartDate"
          [(orderBy)]="orderBy"
          [(direction)]="direction"
          (orderChange)="emitOrderChange()"
        ></vitamui-common-order-by-button>
      </div>

      <div class="col-2 d-flex align-items-center">
        <span>{{ 'ARCHIVE_SEARCH.ARCHIVE_UNIT.FIELDS.END_DATE' | translate }} </span>
        <vitamui-common-order-by-button
          orderByKey="EndDate"
          [(orderBy)]="orderBy"
          [(direction)]="direction"
          (orderChange)="emitOrderChange()"
        ></vitamui-common-order-by-button>
      </div>

      <div class="col-2 d-flex align-items-center">
        <span>{{ 'ARCHIVE_SEARCH.ARCHIVE_UNIT.FIELDS.SP' | translate }}</span>
        <vitamui-common-order-by-button
          orderByKey="#originating_agencies"
          [(orderBy)]="orderBy"
          [(direction)]="direction"
          (orderChange)="emitOrderChange()"
        ></vitamui-common-order-by-button>
      </div>
    </div>

    <div class="vitamui-table-body">
      <div class="vitamui-table-rows" *ngFor="let archiveUnit of archiveUnits; let index = index">
        <div class="vitamui-row d-flex align-items-center clickable" (click)="archiveUnitClick.emit(archiveUnit)">
          <div class="col-1 d-flex align-items-center">
            <span class="table-filter-icon" [ngSwitch]="archiveUnit?.DescriptionLevel">
              <ng-container *ngSwitchCase="'RecordGrp'">
                <i class="vitamui-icon vitamui-icon-folder vitamui-row-icon status-badge"></i>
              </ng-container>
              <ng-container *ngSwitchCase="'File'">
                <i class="vitamui-icon vitamui-icon-file vitamui-row-icon status-badge"></i>
              </ng-container>
              <ng-container *ngSwitchCase="'Item'">
                <i class="vitamui-icon vitamui-icon-file vitamui-row-icon status-badge"></i>
              </ng-container>
            </span>
          </div>
          <div class="col-5 d-flex align-items-center">
            <ng-container *ngIf="archiveUnit?.Title; else subTitleFr">
              <p matTooltip="{{ archiveUnit?.Description }}" matTooltipClass="vitamui-tooltip" [matTooltipShowDelay]="300">
                <b> {{ archiveUnit?.Title }}</b> <br />
                {{ archiveUnit?.Description | truncate: 100 }}
              </p>
            </ng-container>
            <ng-template #subTitleFr>
              <ng-container *ngIf="archiveUnit.Title_.fr; else subTitleEn">
                <p matTooltip="{{ archiveUnit?.Description }}" matTooltipClass="vitamui-tooltip" [matTooltipShowDelay]="300">
                  <b>{{ archiveUnit.Title_.fr }} </b> <br />
                  {{ archiveUnit?.Description | truncate: 100 }}
                </p>
              </ng-container>
            </ng-template>
            <ng-template #subTitleEn>
              <ng-container *ngIf="archiveUnit.Title_.en">
                <p matTooltip="{{ archiveUnit?.Description }}" matTooltipClass="vitamui-tooltip" [matTooltipShowDelay]="300">
                  <b>{{ archiveUnit.Title_.en }} </b> <br />
                  {{ archiveUnit?.Description | truncate: 100 }}
                </p>
              </ng-container>
            </ng-template>
          </div>
          <div class="col-2 d-flex align-items-center">
            {{ archiveUnit?.StartDate | date: 'dd/MM/yyyy' }}
          </div>
          <div class="col-2 d-flex align-items-center">
            {{ archiveUnit?.EndDate | date: 'dd/MM/yyyy' }}
          </div>
          <div class="col-2 d-flex align-items-center">
            <p
              matTooltip="{{ archiveUnit['originating_agencyName'] }}   ({{ archiveUnit['#originating_agencies'] }})"
              matTooltipClass="vitamui-tooltip"
              [matTooltipShowDelay]="300"
            >
              {{ archiveUnit['originating_agencyName'] }}
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="vitamui-table-footer">
      <mat-spinner *ngIf="pending" diameter="50" color="accent"></mat-spinner>
      <button *ngIf="!pending && canLoadMore" (click)="loadMore()" class="btn">
        {{ 'ARCHIVE_SEARCH.SHOW_MORE_RESULTS' | translate }}
      </button>
      <span *ngIf="!pending && !canLoadMore">{{ 'ARCHIVE_SEARCH.NO_MORE_RESULTS' | translate }}</span>
    </div>
  </div>
</div>
